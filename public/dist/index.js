function init(){"true"==window.localStorage.getItem("darkmode")&&(0!=$(".darkModeToggle").length&&($(".darkModeToggle")[0].id="on",$(".darkModeToggle")[0].children[0].textContent="toggle_on"),darkModeHandler()),$(".modal-footer button").first().prop("disabled","true"),$(".darkModeToggle").click(darkModeButtonClicked),$("button[name=\"login\"]").click(loginButtonClicked),$("button[name=\"logout\"]").click(logoutButtonClicked),$("button[name=\"create-account\"]").click(createAccountButtonClicked),$("#create-event-submit").click(createPostSubmit),$(".sortBtn").click(sortButtonClicked),$(".upvote").click(upvoteButtonClicked),$(".thread").click(threadCardClicked),$("button[name=\"deletePost\"]").click(deletePostClicked),$("input[name=\"response\"]").keypress(keyPressedInResponse),$("button[name=\"response\"]").click(function(){location.href="/login"}),$("#signUpForm").keypress(function(a){"13"==a.which&&a.preventDefault()}),$("input[name=\"post-title\"]").on("input",function(){const a=$("input[name=\"post-title\"]").val(),b=80;a.length>=b||0===a.length?$(".modal-footer button").first().prop("disabled","true"):$(".modal-footer button").first().removeAttr("disabled");const c=$("input[name=\"post-title\"]").parent().children().first(),d=b-a.length;if(d<b/2){const a=` ${d} Characters left`;0===c.children().length?c.html(c.text()+`<span>${a}</span>`):c.children().first().text(a),0===d&&c.children().first().text(a+" \uD83D\uDE32")}else 0!==c.children().length&&c.children().first().remove()})}function darkModeButtonClicked(){"off"===$(this).attr("id")?($(this).attr("id","on"),$(this).children().text("toggle_on"),window.localStorage.setItem("darkmode","true")):($(this).attr("id","off"),$(this).children().text("toggle_off"),window.localStorage.setItem("darkmode","false")),darkModeHandler()}function loginButtonClicked(){let a=$("input[name=\"email\"]").val(),b=$("input[name=\"password\"]").val();console.log(a,b),$.post("/api/user/login",{email:a,password:b}).done(function(){location.href="/"}).fail(function(a){console.log(a.responseJSON.message)})}function createAccountButtonClicked(){console.log("trying to create account");const a={email:$("input[name=\"email\"]").val(),username:$("input[name=\"username\"]").val(),password:$("input[name=\"password\"]").val(),confirmPassword:$("input[name=\"confirmPassword\"]").val()},b="<span> This field is required</span>";let c=!1;for(const d in a){let e=$(`p[for="${d}"]`);0===a[d].length?(0===e.first().children().length?e.html(e.text()+b):(e.first().children().first().remove(),e.html(e.text()+b)),c=!0):0!==e.first().children().length&&e.first().children().first().remove()}c||promptPasswordErrors({password:a.password,confirmPassword:a.confirmPassword})||$.post("/api/user/register",{email:a.email,username:a.username,password:a.password},function(){console.log("sent")}).done(function(){console.log("received"),$("form").submit(),setTimeout(function(){location.href="/"},2500)}).fail(function(a){if(a.responseJSON.problem){const b=` <span>${a.responseJSON.message}</span>`;let c=$(`p[for="${a.responseJSON.problem}"]`);0===c.first().children().length?c.html(c.text()+b):(c.first().children().first().remove(),c.html(c.text()+b))}else console.log(a.responseJSON.message)})}function promptPasswordErrors(a){const b={passwordEl:$("p[for=\"password\"]"),passwordConfirmEl:$("p[for=\"confirmPassword\"]")};let c=!1,d="";if(a.password!==a.confirmPassword&&(d="<span> Passwords do not match</span>",c=!0),6>a.password.length&&(d="<span> Passwords must be atleast 6 characters</span>",c=!0),c)for(const a in b)0===b[a].first().children().length?b[a].html(b[a].text()+d):(b[a].first().children().first().remove(),b[a].html(b[a].text()+d));return c}function logoutButtonClicked(){$.post("/api/user/logout").done(function(){location.href="/"}).fail(function(a){console.log(a.responseJSON.message)})}function createPostSubmit(){let a=$("input[name=\"post-title\"]").val(),b=$("textarea[name=\"post-description\"]").val(),c=$("input[name=\"post-location\"]").val(),d=$("input[name=\"post-date\"]").val(),e=$("input[name=\"post-time\"]").val();80<a.length||$.post("/api/post/create",{title:a,description:b,location:c,date:`${d} ${e}`},function(){console.log("sent")}).done(function(){console.log("created"),document.getElementById("close-create-post-button").click(),c.href="/"}).fail(function(a){console.log(a.responseJSON.message)})}function sortButtonClicked(){for(let a=0;a<$(".sortBtn").length;a++)$(".sortBtn")[a].id="";$(this).attr("id","active"),console.log(`${$(this).text().toLowerCase()}`),$.post("/",{sort:`${$(this).text().toLowerCase()}`}).done(function(){console.log("created")}).fail(function(a){console.log(a.responseJSON.message)})}function upvoteButtonClicked(a){if(a.stopPropagation(),$(a.target).is("a"))return;let b=$(this).parent().parent().children().first(),c=0;$(this)[0].classList.contains("upvote-activated")?($(this).removeClass("upvote-activated"),b.text(+$(this).parent().parent().children().first().text()-1),c=-1):($(this).addClass("upvote-activated"),b.text(+$(this).parent().parent().children().first().text()+1),c=1),$.post(`/api/post/upvote/${$(this).attr("id")}`,{increment:c}).done(function(a){console.log("created",a.message)}).fail(function(a){console.log("error",a.message)})}function threadCardClicked(){location.href=`/post/${$(this).attr("id")}`}function deletePostClicked(){$.post(`/api/post/delete/${$(this).parent().parent().parent().attr("id")}`).done(function(){location.href="/"})}function keyPressedInResponse(a){13===a.keyCode&&$.post("/api/response/",{post_id:$(".post").attr("id"),response:$("input[name=\"response\"]").val()}).done(function(){console.log("done"),location.reload()}).fail(function(a){console.log(a.message)})}function darkModeHandler(){"true"==window.localStorage.getItem("darkmode")?(document.documentElement.style.setProperty("--background-color","#000000"),document.documentElement.style.setProperty("--card-background-color","#1A1A1B"),document.documentElement.style.setProperty("--main-color","#9407F2"),document.documentElement.style.setProperty("--confirm-color","#ec28cf"),document.documentElement.style.setProperty("--text-shade","#BFBFBF"),document.documentElement.style.setProperty("--text-dark","#D7DADC"),document.documentElement.style.setProperty("--button-hover-on-white","#272727")):(document.documentElement.style.setProperty("--background-color","#DAE0E6"),document.documentElement.style.setProperty("--card-background-color","#FFFFFF"),document.documentElement.style.setProperty("--main-color","#9407F2"),document.documentElement.style.setProperty("--confirm-color","#F673E3"),document.documentElement.style.setProperty("--text-shade","#757575"),document.documentElement.style.setProperty("--text-dark","#424242"),document.documentElement.style.setProperty("--button-hover-on-white","#E1E1E1"))}init();